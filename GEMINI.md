# プロジェクト企画書: Plane SNS (自動SNSアカウント販売プラットフォーム)

**バージョン:** 2.0
**最終更新日:** 2025年10月19日
**本文書の目的:** 本書は、`plane-sns`プロジェクトのための包括的な企画書です。AI開発アシスタントがプロジェクトの目標、アーキテクチャ、現状を迅速に理解し、効率的かつ自律的に開発を遂行できるだけのコンテキストを提供することを目的とします。

---

## 1. エグゼクティブサマリー

### 1.1. コンセプト

**Plane SNS**は、SNSアカウントの安全な販売と引き渡しを目的として設計された、特化型の完全自動Eコマースプラットフォームです。

### 1.2. 中核的な価値提案

本プラットフォームは、在庫管理から安全な決済処理（PayPay経由）、顧客へのアカウント情報引き渡しまで、SNSアカウント販売のライフサイクル全体を自動化します。これにより、手動での作業を最小限に抑え、セキュリティを強化し、シSeamlessなユーザー体験を提供します。

### 1.3. 現状のステータス

**MVP（Minimum Viable Product）は98%完成しています。** 主要な機能は実装済みで安定しており、プロジェクトは本番稼働前の最終段階にあります。現在の焦点は、コードの品質改善と機能強化です。

### 1.4. 直近の目標

1.  **コード品質の保証:** 全てのLintエラー（例: `any`型、未使用変数）を解消し、コードの堅牢性と保守性を向上させます。
2.  **管理者ダッシュボードの強化:** 管理者向けに、価値ある販売インサイトを提供する分析機能を実装します。

---

## 2. システムアーキテクチャと主要技術

本プラットフォームは、各技術の長所を最大限に活用するため、モダンなハイブリッドアーキテクチャを採用しています。

- **フレームワーク:** Next.js 15 (App Router)
- **主要言語:** TypeScript
- **UI:** React 19, TailwindCSS
- **スタイリング/テーマ:** `next-themes` によるダークモード対応
- **状態管理:** Zustand (主にクライアントサイドのカート機能)
- **データベース:** Supabase (PostgreSQL)
- **認証:** Supabase Auth (ユーザー向け), **JWTベース** (管理者向けのセキュアな認証)
- **バックエンドサービス:**
  - **コアAPI & Webサーバー:** Node.js (Next.jsフレームワークに統合)
  - **決済ゲートウェイ:** `paypaython-mobile`ライブラリをラップし、PayPay取引を処理する専用の**Python**サービス

---

## 3. 主要機能

### 3.1. ユーザー向け機能

- **商品カタログ:** 販売中のSNSアカウント一覧
- **ユーザー認証:** 安全なサインアップとログイン (Supabase Auth)
- **ショッピングカート:** 購入前の商品管理 (Zustand)
- **決済システム:** PayPayによるクレジットチャージ機能
- **自動購入:** チャージしたクレジットを利用した即時アカウント購入

### 3.2. 管理者向け機能

- **セキュアな管理パネル:** JWT認証によるアクセス制限
- **在庫管理:** SNSアカウントの完全なCRUD（作成、読み取り、更新、削除）機能
- **注文管理:** 全ての顧客注文の表示と追跡
- **変更履歴:** 在庫に加えられた全ての変更の監査証跡（操作した管理者と紐付け）

---

## 4. 開発とデプロイ

### 4.1. ローカル開発環境のセットアップ

**前提条件:**

- Node.js (v18以上)
- Python (v3.8以上)
- SupabaseアカウントおよびCLI
- PayPay開発者アカウント

**インストール手順:**

```bash
# フロントエンドの依存関係をインストール
npm install

# バックエンド (Python) の依存関係をインストール
pip install paypaython-mobile
```

**環境変数:**

- `.env.example`を元に`.env.local`ファイルを作成します。SupabaseとPayPayのAPIキー、および管理者アカウント情報を設定してください。

### 4.2. デプロイ

- **フロントエンド:** Next.jsアプリケーションはVercelにデプロイします。
- **バックエンド (Python):** 決済サービスは、HerokuやVercel Functionsなどの別サービスにデプロイします。

---

## 5. プロジェクトロードマップと直近のタスク

### 5.1. 完了したマイルストーン (v1.3)

- **ダークモード:** `next-themes`を導入し、ユーザーが選択可能なライト/ダークテーマ切替機能を実装完了。
- **バグ修正 (変更履歴):** 管理者IDの不一致により商品履歴が記録されていなかった重大なバグを修正。現在は正しい管理者のUUIDが記録されます。
- **セキュリティ強化:** 簡易的な管理者認証を、堅牢なJWTベースのシステムに刷新。

### 5.2. バックログ: 現在のスプリント

#### **タスク1: コード品質保証 (Lint修正)**

- **目的:** 厳格な型付けを強制し、不要なコードを排除することで、コード品質を向上させ、将来のバグを予防する。
- **主要なアクション:**
  1. `npm run lint` を実行する。
  2. コードベース内の`any`型を全て特定する。
  3. 各`any`を適切なTypeScriptの型またはインターフェースに置き換える。
  4. 未使用の変数やインポートを全て特定し、削除する。
- **調査対象ファイル:** まずはAPIルートやデータ取得コンポーネント（例: `app/api/site-control-a4b7/items/route.ts`）から着手する。

#### **タスク2: 管理者ダッシュボードの分析機能**

- **目的:** プラットフォームのパフォーマンスに関するデータ駆動の洞察を管理者に提供する。
- **主要なアクション:**
  1. 管理者ダッシュボード用の新しいUIコンポーネントを設計する。
  2. 売上集計データ（例: 日別の収益、人気商品）を取得するための新しいAPIエンドポイントを作成する。
  3. データをシンプルなグラフやテーブルで可視化する。

---

## 6. 付録

### 6.1. FAQ

- **Q: なぜPythonとNode.jsのハイブリッドバックエンドなのですか？**
  - **A:** 適材適所で最適なツールを利用するためです。Node.js (Next.js) はWebリクエストやAPIルーティングの処理に優れており、一方、Pythonには要求された決済連携のための成熟し安定したライブラリ (`paypaython-mobile`) が存在します。

### 6.2. 変更履歴

- **v1.3 (2025-10-18):** ダークモード追加、履歴バグ修正、管理者ページの安定性向上。
- **v1.2 (2025-10-18):** JWTによるセキュリティ強化、依存関係の脆弱性を修正。
- **v1.1 (2025-10-17):** 管理者UI/UXの改善。
