# ğŸ†“ å®Œå…¨ç„¡æ–™ã§PayPayæ©Ÿèƒ½ä»˜ããƒ‡ãƒ—ãƒ­ã‚¤ã™ã‚‹æ–¹æ³•

PayPayæ©Ÿèƒ½ï¼ˆPythonï¼‰ã‚’å«ã‚ã¦**å®Œå…¨ç„¡æ–™**ã§ãƒ‡ãƒ—ãƒ­ã‚¤ã™ã‚‹æ–¹æ³•ã‚’ç´¹ä»‹ã—ã¾ã™ã€‚

## ğŸ¯ å®Œå…¨ç„¡æ–™ã‚ªãƒ—ã‚·ãƒ§ãƒ³

### âœ… ã‚ªãƒ—ã‚·ãƒ§ãƒ³1: **Vercel (ãƒ•ãƒ­ãƒ³ãƒˆ) + Google Cloud Run (PayPay)** â­æ¨å¥¨!

**å®Œå…¨ç„¡æ–™ã®ç†ç”±:**
- âœ… Vercel: Hobbyãƒ—ãƒ©ãƒ³ç„¡æ–™
- âœ… Google Cloud Run: æœˆ200ä¸‡ãƒªã‚¯ã‚¨ã‚¹ãƒˆç„¡æ–™
- âœ… åˆè¨ˆ: **$0/æœˆ**

**ãƒ¡ãƒªãƒƒãƒˆ:**
- ğŸš€ Vercelã§é«˜é€Ÿãªãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰
- ğŸ Cloud Runã§Pythonã‚³ãƒ³ãƒ†ãƒŠå®Ÿè¡Œ
- ğŸ’° å°ã€œä¸­è¦æ¨¡ãªã‚‰æ°¸ä¹…ç„¡æ–™
- ğŸ”§ æ¯”è¼ƒçš„ç°¡å˜ãªã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—

**ãƒ‡ãƒ¡ãƒªãƒƒãƒˆ:**
- Google Cloudã‚¢ã‚«ã‚¦ãƒ³ãƒˆãŒå¿…è¦ï¼ˆã‚¯ãƒ¬ã‚«ç™»éŒ²å¿…è¦ã ãŒèª²é‡‘ã•ã‚Œãªã„ï¼‰
- Dockerã®åŸºæœ¬çŸ¥è­˜ãŒå¿…è¦

**ã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—æ™‚é–“:** 30åˆ†

---

### âœ… ã‚ªãƒ—ã‚·ãƒ§ãƒ³2: **Vercel + Supabase Edge Functions** â­æœ€ã‚‚ã‚·ãƒ³ãƒ—ãƒ«!

**å®Œå…¨ç„¡æ–™ã®ç†ç”±:**
- âœ… Vercel: ç„¡æ–™
- âœ… Supabase Edge Functions: æœˆ50ä¸‡ãƒªã‚¯ã‚¨ã‚¹ãƒˆç„¡æ–™
- âœ… åˆè¨ˆ: **$0/æœˆ**

**ãƒ¡ãƒªãƒƒãƒˆ:**
- ğŸš€ æ—¢ã«Supabaseã‚’ä½¿ã£ã¦ã„ã‚‹ã®ã§çµ±åˆãŒç°¡å˜
- ğŸ’° å®Œå…¨ç„¡æ–™
- âš¡ ã‚¨ãƒƒã‚¸ã§é«˜é€Ÿå®Ÿè¡Œ
- ğŸ”§ æœ€ã‚‚ã‚·ãƒ³ãƒ—ãƒ«ï¼ˆDenoãƒ™ãƒ¼ã‚¹ï¼‰

**ãƒ‡ãƒ¡ãƒªãƒƒãƒˆ:**
- PayPaython-mobileã‚’Denoã§å‹•ã‹ã™å¿…è¦ãŒã‚ã‚‹
- ã¾ãŸã¯PayPay APIã‚’ç›´æ¥å®Ÿè£…ã™ã‚‹å¿…è¦ãŒã‚ã‚‹

**ã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—æ™‚é–“:** 1-2æ™‚é–“ï¼ˆPayPayå®Ÿè£…æ¬¡ç¬¬ï¼‰

---

### âœ… ã‚ªãƒ—ã‚·ãƒ§ãƒ³3: **Render (ç„¡æ–™æ )** 

**å®Œå…¨ç„¡æ–™ã®ç†ç”±:**
- âœ… Render: ç„¡æ–™æ ã‚ã‚Šï¼ˆåˆ¶é™ä»˜ãï¼‰
- âœ… Python + Node.jsä¸¡æ–¹ã‚µãƒãƒ¼ãƒˆ
- âœ… åˆè¨ˆ: **$0/æœˆ**

**ãƒ¡ãƒªãƒƒãƒˆ:**
- ğŸ Pythonãƒã‚¤ãƒ†ã‚£ãƒ–ã‚µãƒãƒ¼ãƒˆ
- ğŸš€ 1ã¤ã®ã‚µãƒ¼ãƒ“ã‚¹ã§å®Œçµ
- ğŸ’° ç„¡æ–™

**ãƒ‡ãƒ¡ãƒªãƒƒãƒˆ:**
- â° 15åˆ†ã‚¢ã‚¯ã‚»ã‚¹ãªã—ã§ã‚¹ãƒªãƒ¼ãƒ—
- ğŸŒ ã‚³ãƒ¼ãƒ«ãƒ‰ã‚¹ã‚¿ãƒ¼ãƒˆé…ã„ï¼ˆ30ç§’ã€œ1åˆ†ï¼‰
- ğŸ“Š æœˆ750æ™‚é–“åˆ¶é™

**ã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—æ™‚é–“:** 15åˆ†

---

### âœ… ã‚ªãƒ—ã‚·ãƒ§ãƒ³4: **Oracle Cloud (Always Free)** 

**å®Œå…¨ç„¡æ–™ã®ç†ç”±:**
- âœ… Oracle Cloud: Always Freeãƒ†ã‚£ã‚¢ï¼ˆæ°¸ä¹…ç„¡æ–™ï¼‰
- âœ… VM 2å°ç„¡æ–™
- âœ… åˆè¨ˆ: **$0/æœˆ**

**ãƒ¡ãƒªãƒƒãƒˆ:**
- ğŸ’ª å¼·åŠ›ãªã‚¹ãƒšãƒƒã‚¯ï¼ˆARM Ampere 4ã‚³ã‚¢ã€24GB RAMï¼‰
- ğŸ Pythonã‚‚Node.jsã‚‚è‡ªç”±ã«
- ğŸ’° æ°¸ä¹…ç„¡æ–™

**ãƒ‡ãƒ¡ãƒªãƒƒãƒˆ:**
- ğŸ”§ è‡ªåˆ†ã§ã‚µãƒ¼ãƒãƒ¼ç®¡ç†ãŒå¿…è¦
- ğŸŒ ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£è¨­å®šãŒå¿…è¦
- ğŸ“š å­¦ç¿’ã‚³ã‚¹ãƒˆé«˜ã„

**ã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—æ™‚é–“:** 1-2æ™‚é–“

---

## ğŸ“‹ è©³ç´°æ¯”è¼ƒè¡¨

| é …ç›® | Vercel+Cloud Run | Vercel+Supabase | Render | Oracle Cloud |
|-----|------------------|-----------------|--------|--------------|
| **å®Œå…¨ç„¡æ–™** | âœ… | âœ… | âœ… | âœ… |
| **ã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—** | ä¸­ç¨‹åº¦ | ç°¡å˜ | ç°¡å˜ | é›£ã—ã„ |
| **Pythonã‚µãƒãƒ¼ãƒˆ** | âœ… | âŒ(Deno) | âœ… | âœ… |
| **ã‚³ãƒ¼ãƒ«ãƒ‰ã‚¹ã‚¿ãƒ¼ãƒˆ** | é€Ÿã„ | æœ€é€Ÿ | é…ã„ | ãªã—(å¸¸æ™‚èµ·å‹•) |
| **ãƒªã‚¯ã‚¨ã‚¹ãƒˆåˆ¶é™** | 200ä¸‡/æœˆ | 50ä¸‡/æœˆ | ç„¡åˆ¶é™ | ç„¡åˆ¶é™ |
| **ã‚¹ãƒªãƒ¼ãƒ—** | ãªã— | ãªã— | 15åˆ†ã§ã‚¹ãƒªãƒ¼ãƒ— | ãªã— |
| **æ¨å¥¨åº¦** | â­â­â­â­â­ | â­â­â­â­ | â­â­â­ | â­â­ |

---

## ğŸš€ æ¨å¥¨: Vercel + Google Cloud Run

### ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£
```
ãƒ¦ãƒ¼ã‚¶ãƒ¼
  â†“
Vercel (Next.js - ç„¡æ–™)
  â†“ (PayPayå‡¦ç†ã®ã¿)
Cloud Run (Python Container - ç„¡æ–™æ )
  â†“
PayPay API
```

### ç„¡æ–™æ ã®è©³ç´°
- **Vercel**: 100GBå¸¯åŸŸ/æœˆã€ç„¡åˆ¶é™ãƒ‡ãƒ—ãƒ­ã‚¤
- **Cloud Run**: 
  - æœˆ200ä¸‡ãƒªã‚¯ã‚¨ã‚¹ãƒˆç„¡æ–™
  - 36ä¸‡GBç§’ã®å®Ÿè¡Œæ™‚é–“ç„¡æ–™
  - 180,000 vCPUç§’ç„¡æ–™
  - å°è¦æ¨¡ã‚¢ãƒ—ãƒªãªã‚‰ååˆ†!

---

## ğŸ“ ã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—æ‰‹é †

### ã‚¹ãƒ†ãƒƒãƒ—1: Cloud Runç”¨ã®Dockerfileã‚’ä½œæˆ

ã¾ãšã€PayPayå°‚ç”¨ã®APIã‚µãƒ¼ãƒ“ã‚¹ã‚’ä½œæˆã—ã¾ã™:

#### ãƒ•ã‚¡ã‚¤ãƒ«æ§‹é€ 
```
paypay-service/
  â”œâ”€â”€ Dockerfile
  â”œâ”€â”€ requirements.txt
  â”œâ”€â”€ main.py
  â””â”€â”€ paypay_handler.py
```

#### 1. `paypay-service/Dockerfile`
```dockerfile
FROM python:3.11-slim

WORKDIR /app

COPY requirements.txt .
RUN pip install --no-cache-dir -r requirements.txt

COPY . .

CMD ["python", "main.py"]
```

#### 2. `paypay-service/requirements.txt`
```
PayPaython-mobile
flask
gunicorn
```

#### 3. `paypay-service/main.py`
```python
from flask import Flask, request, jsonify
from paypay_handler import handle_paypay_request
import os

app = Flask(__name__)

@app.route('/paypay', methods=['POST'])
def paypay_endpoint():
    try:
        data = request.get_json()
        result = handle_paypay_request(data)
        return jsonify({"success": True, "data": result})
    except Exception as e:
        return jsonify({"success": False, "error": str(e)}), 500

@app.route('/health', methods=['GET'])
def health():
    return jsonify({"status": "healthy"})

if __name__ == '__main__':
    port = int(os.environ.get('PORT', 8080))
    app.run(host='0.0.0.0', port=port)
```

#### 4. `paypay-service/paypay_handler.py`
```python
# æ—¢å­˜ã®client.pyã®ãƒ­ã‚¸ãƒƒã‚¯ã‚’ç§»æ¤
from PayPaython_mobile import PayPay
import os

def handle_paypay_request(data):
    action = data.get("action")
    access_token = data.get("access_token")
    
    paypay = PayPay(access_token=access_token)
    
    if action == "link_check":
        return check_link(paypay, data)
    elif action == "link_receive":
        return receive_link(paypay, data)
    # ... ä»–ã®ã‚¢ã‚¯ã‚·ãƒ§ãƒ³
```

### ã‚¹ãƒ†ãƒƒãƒ—2: Cloud Runã«ãƒ‡ãƒ—ãƒ­ã‚¤

```bash
# Google Cloud SDKã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ï¼ˆåˆå›ã®ã¿ï¼‰
# https://cloud.google.com/sdk/docs/install

# ãƒ­ã‚°ã‚¤ãƒ³
gcloud auth login

# ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆä½œæˆ
gcloud projects create plane-sns-paypay --name="Plane SNS PayPay"
gcloud config set project plane-sns-paypay

# Cloud Runã‚µãƒ¼ãƒ“ã‚¹ã‚’æœ‰åŠ¹åŒ–
gcloud services enable run.googleapis.com
gcloud services enable cloudbuild.googleapis.com

# ãƒ‡ãƒ—ãƒ­ã‚¤ï¼ˆè‡ªå‹•ã§ãƒ“ãƒ«ãƒ‰ï¼†ãƒ‡ãƒ—ãƒ­ã‚¤ï¼‰
cd paypay-service
gcloud run deploy paypay-service \
  --source . \
  --platform managed \
  --region asia-northeast1 \
  --allow-unauthenticated \
  --set-env-vars PAYPAY_ACCESS_TOKEN=your_token

# URLãŒè¡¨ç¤ºã•ã‚Œã‚‹ï¼ˆä¾‹: https://paypay-service-xxx.run.appï¼‰
```

### ã‚¹ãƒ†ãƒƒãƒ—3: Next.jsã‹ã‚‰Cloud Runã‚’å‘¼ã³å‡ºã™

```typescript
// lib/paypay/cloud-run-client.ts
export class CloudRunPayPayClient {
  private cloudRunUrl: string;

  constructor() {
    this.cloudRunUrl = process.env.PAYPAY_CLOUD_RUN_URL!;
  }

  async checkLink(linkUrl: string) {
    const response = await fetch(`${this.cloudRunUrl}/paypay`, {
      method: 'POST',
      headers: { 'Content-Type': 'application/json' },
      body: JSON.stringify({
        action: 'link_check',
        link_url: linkUrl,
        access_token: process.env.PAYPAY_ACCESS_TOKEN
      })
    });
    
    const result = await response.json();
    if (!result.success) throw new Error(result.error);
    return result.data;
  }
  
  // ä»–ã®ãƒ¡ã‚½ãƒƒãƒ‰ã‚‚åŒæ§˜ã«å®Ÿè£…
}
```

### ã‚¹ãƒ†ãƒƒãƒ—4: Vercelã«ãƒ‡ãƒ—ãƒ­ã‚¤

```bash
# ç’°å¢ƒå¤‰æ•°ã«è¿½åŠ 
vercel env add PAYPAY_CLOUD_RUN_URL
# Cloud Runã®URLï¼ˆhttps://paypay-service-xxx.run.appï¼‰ã‚’å…¥åŠ›

# ãƒ‡ãƒ—ãƒ­ã‚¤
vercel --prod
```

---

## ğŸ¨ æœ€ã‚‚ã‚·ãƒ³ãƒ—ãƒ«: Render (ç„¡æ–™æ )

ã‚³ãƒ¼ãƒ«ãƒ‰ã‚¹ã‚¿ãƒ¼ãƒˆã‚’æ°—ã«ã—ãªã„ãªã‚‰ã€RenderãŒæœ€ã‚‚ã‚·ãƒ³ãƒ—ãƒ«ã§ã™ã€‚

### ã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—æ‰‹é †

#### 1. `render.yaml` ã‚’ä½œæˆ
```yaml
services:
  - type: web
    name: plane-sns
    env: node
    buildCommand: npm install && npm run build
    startCommand: npm run start
    envVars:
      - key: NEXT_PUBLIC_SUPABASE_URL
        sync: false
      - key: NEXT_PUBLIC_SUPABASE_ANON_KEY
        sync: false
      - key: SUPABASE_SERVICE_ROLE_KEY
        sync: false
      - key: ADMIN_SESSION_SECRET
        sync: false
      - key: PAYPAY_ACCESS_TOKEN
        sync: false
      - key: PYTHON_PATH
        value: python3
```

#### 2. `requirements.txt` ã‚’ä½œæˆï¼ˆãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆãƒ«ãƒ¼ãƒˆã«ï¼‰
```
PayPaython-mobile
```

#### 3. Renderã«ãƒ‡ãƒ—ãƒ­ã‚¤
1. https://render.com ã«ã‚¢ã‚¯ã‚»ã‚¹
2. GitHubã§ã‚µã‚¤ãƒ³ã‚¢ãƒƒãƒ—
3. "New Web Service"
4. ãƒªãƒã‚¸ãƒˆãƒªã‚’é¸æŠ
5. "Apply" ã‚’ã‚¯ãƒªãƒƒã‚¯

**æ³¨æ„**: 15åˆ†ã‚¢ã‚¯ã‚»ã‚¹ãŒãªã„ã¨ã‚¹ãƒªãƒ¼ãƒ—ã—ã¾ã™ï¼ˆåˆå›ã‚¢ã‚¯ã‚»ã‚¹ã¯30ç§’ã€œ1åˆ†ã‹ã‹ã‚‹ï¼‰

---

## ğŸ’¡ ã‚³ã‚¹ãƒˆæ¯”è¼ƒï¼ˆæœˆé–“1000ãƒªã‚¯ã‚¨ã‚¹ãƒˆã®å ´åˆï¼‰

| ã‚µãƒ¼ãƒ“ã‚¹ | ã‚³ã‚¹ãƒˆ | åˆ¶é™ |
|---------|--------|------|
| Vercel + Cloud Run | $0 | ç„¡æ–™æ å†… |
| Vercel + Supabase | $0 | ç„¡æ–™æ å†… |
| Render | $0 | ã‚¹ãƒªãƒ¼ãƒ—ã‚ã‚Š |
| Railway | $5 | ã‚¹ãƒªãƒ¼ãƒ—ãªã— |

---

## ğŸ¯ æœ€çµ‚æ¨å¥¨

### ğŸ‘¨â€ğŸ’» æŠ€è¡“ã«è‡ªä¿¡ãŒã‚ã‚‹æ–¹:
â†’ **Vercel + Google Cloud Run**
- å®Œå…¨ç„¡æ–™
- é«˜æ€§èƒ½
- ã‚¹ãƒªãƒ¼ãƒ—ãªã—

### ğŸš€ ã¨ã«ã‹ãç°¡å˜ã«:
â†’ **Render ç„¡æ–™æ **
- æœ€ã‚‚ç°¡å˜
- ã‚¹ãƒªãƒ¼ãƒ—ã‚ã‚Šï¼ˆ15åˆ†ï¼‰
- ã‚³ãƒ¼ãƒ«ãƒ‰ã‚¹ã‚¿ãƒ¼ãƒˆé…ã„

### ğŸ’° å°‘é¡ãªã‚‰æ‰•ã£ã¦ã‚‚OK:
â†’ **Railway** ($5/æœˆ)
- æœ€ã‚‚ãƒãƒ©ãƒ³ã‚¹ãŒè‰¯ã„
- ã‚¹ãƒªãƒ¼ãƒ—ãªã—
- é«˜é€Ÿ

---

## ğŸ“š æ¬¡ã®ã‚¹ãƒ†ãƒƒãƒ—

ã©ã®æ–¹æ³•ã§é€²ã‚ã¾ã™ã‹ï¼Ÿ

1. **Vercel + Cloud Run** - å®Œå…¨ç„¡æ–™ã€ä¸­ç¨‹åº¦ã®é›£æ˜“åº¦ï¼ˆ30åˆ†ï¼‰
2. **Render** - å®Œå…¨ç„¡æ–™ã€è¶…ç°¡å˜ã€ã‚¹ãƒªãƒ¼ãƒ—ã‚ã‚Šï¼ˆ15åˆ†ï¼‰
3. **Railway** - $5/æœˆã€æœ€ã‚‚å¿«é©ï¼ˆ10åˆ†ï¼‰

å¿…è¦ãªãƒ•ã‚¡ã‚¤ãƒ«ã‚’ä½œæˆã—ã¾ã™ã‹ï¼Ÿ
